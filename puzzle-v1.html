<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Puzzle V1</title>
    <style>
        :root {
            --bg: #121212;
            --card: #1e1e1e;
            --accent: #00d2d3;
            --win: #1dd1a1;
            --lose: #ff6b6b;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--bg);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 20px;
        }

        .stats-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .stat {
            background: var(--card);
            padding: 10px 20px;
            border-radius: 10px;
            border: 1px solid #333;
            text-align: center;
            min-width: 80px;
        }

        .stat label { font-size: 0.8rem; color: #888; display: block; }
        .stat span { font-size: 1.4rem; font-weight: bold; }

        #board {
            display: grid;
            gap: 8px;
            background: #252525;
            padding: 12px;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.6);
        }

        .tile {
            position: relative;
            background: #333;
            border-radius: 8px;
            cursor: pointer;
            overflow: hidden;
            border: 2px solid transparent;
            transition: transform 0.1s;
        }

        .tile:active { transform: scale(0.95); }
        .tile.selected { border-color: var(--accent); box-shadow: 0 0 15px var(--accent); }
        .tile.empty { background: var(--bg); border: 2px dashed #444; }
        .tile.empty span { display: none; }

        .btn-reset {
            margin-top: 30px;
            background: transparent;
            color: #888;
            border: 1px solid #444;
            padding: 8px 20px;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .timer-warning { color: var(--lose) !important; animation: pulse 0.5s infinite; }
        @keyframes pulse { 50% { opacity: 0.5; } }
    </style>
</head>
<body>

    <div class="stats-bar">
        <div class="stat"><label>LEVEL</label><span id="lvl">1</span></div>
        <div class="stat"><label>GRID</label><span id="grd">3x3</span></div>
        <div class="stat"><label>WAKTU</label><span id="tmr">60</span></div>
        <div class="stat"><label>SKOR</label><span id="skr">0</span></div>
    </div>

    <div id="board"></div>

    <button class="btn-reset" onclick="confirmRestart()">Restart Game</button>

    <script>
        // DAFTAR 500 EMOJI MANUAL
        const levelEmojis = [
            "ğŸ˜€", "ğŸ˜ƒ", "ğŸ˜„", "ğŸ˜", "ğŸ˜†", "ğŸ˜…", "ğŸ¤£", "ğŸ˜‚", "ğŸ™‚", "ğŸ™ƒ", "ğŸ˜‰", "ğŸ˜Š", "ğŸ˜‡", "ğŸ¥°", "ğŸ˜", "ğŸ¤©", "ğŸ˜˜", "ğŸ˜—", "ğŸ˜š", "ğŸ˜™",
            "ğŸ˜‹", "ğŸ˜›", "ğŸ˜œ", "ğŸ¤ª", "ğŸ˜", "ğŸ¤‘", "ğŸ¤—", "ğŸ¤­", "ğŸ¤«", "ğŸ¤”", "ğŸ¤", "ğŸ¤¨", "ğŸ˜", "ğŸ˜‘", "ğŸ˜¶", "ğŸ˜", "ğŸ˜’", "ğŸ™„", "ğŸ˜¬", "ğŸ¤¥",
            "ğŸ˜Œ", "ğŸ˜”", "ğŸ˜ª", "ğŸ¤¤", "ğŸ˜´", "ğŸ˜·", "ğŸ¤’", "ğŸ¤•", "ğŸ¤¢", "ğŸ¤®", "ğŸ¤§", "ğŸ¥µ", "ğŸ¥¶", "ğŸ¥´", "ğŸ˜µ", "ğŸ¤¯", "ğŸ¤ ", "ğŸ¥³", "ğŸ˜", "ğŸ¤“",
            "ğŸ§", "ğŸ˜•", "ğŸ˜Ÿ", "ğŸ™", "â˜¹ï¸", "ğŸ˜®", "ğŸ˜¯", "ğŸ˜²", "ğŸ˜³", "ğŸ¥º", "ğŸ˜¦", "ğŸ˜§", "ğŸ˜¨", "ğŸ˜°", "ğŸ˜¥", "ğŸ˜¢", "ğŸ˜­", "ğŸ˜±", "ğŸ˜–", "ğŸ˜£",
            "ğŸ˜", "ğŸ˜“", "ğŸ˜©", "ğŸ˜«", "ğŸ¥±", "ğŸ˜¤", "ğŸ˜¡", "ğŸ˜ ", "ğŸ¤¬", "ğŸ˜ˆ", "ğŸ‘¿", "ğŸ’€", "â˜ ï¸", "ğŸ’©", "ğŸ¤¡", "ğŸ‘¹", "ğŸ‘º", "ğŸ‘»", "ğŸ‘½", "ğŸ‘¾",
            "ğŸ¤–", "ğŸ˜º", "ğŸ˜¸", "ğŸ˜»", "ğŸ˜¼", "ğŸ˜½", "ğŸ™€", "ğŸ˜¿", "ğŸ˜¾", "ğŸ™ˆ", "ğŸ™‰", "ğŸ™Š", "ğŸ’‹", "ğŸ’Œ", "ğŸ’˜", "ğŸ’", "ğŸ’–", "ğŸ’—", "ğŸ’“", "ğŸ’",
            "ğŸ’•", "ğŸ’Ÿ", "â£ï¸", "ğŸ’”", "â¤ï¸", "ğŸ§¡", "ğŸ’›", "ğŸ’š", "ğŸ’™", "ğŸ’œ", "ğŸ¤", "ğŸ–¤", "ğŸ¤", "ğŸ’¯", "ğŸ’¢", "ğŸ’¥", "ğŸ’«", "ğŸ’¦", "ğŸ’¨", "ğŸ•³ï¸",
            "ğŸ’£", "ğŸ’¬", "ğŸ‘ï¸â€ğŸ—¨ï¸", "ğŸ—¨ï¸", "ğŸ—¯ï¸", "ğŸ’­", "ğŸ’¤", "ğŸ‘‹", "ğŸ¤š", "ğŸ–ï¸", "âœ‹", "ğŸ––", "ğŸ‘Œ", "ğŸ¤", "âœŒï¸", "ğŸ¤", "ğŸ¤Ÿ", "ğŸ¤˜", "ğŸ¤™", "ğŸ‘ˆ",
            "ğŸ‘‰", "ğŸ‘†", "ğŸ–•", "ğŸ‘‡", "â˜ï¸", "ğŸ‘", "ğŸ‘", "âœŠ", "ğŸ‘Š", "ğŸ¤›", "ğŸ¤œ", "ğŸ‘", "ğŸ™Œ", "ğŸ‘", "ğŸ¤²", "ğŸ¤", "ğŸ™", "âœï¸", "ğŸ’…", "ğŸ¤³",
            "ğŸ’ª", "ğŸ¦¾", "ğŸ¦µ", "ğŸ¦¿", "ğŸ¦¶", "ğŸ‘‚", "ğŸ¦»", "ğŸ‘ƒ", "ğŸ§ ", "ğŸ¦·", "ğŸ¦´", "ğŸ‘€", "ğŸ‘ï¸", "ğŸ‘…", "ğŸ‘„", "ğŸ‘¶", "ğŸ§’", "ğŸ‘¦", "ğŸ‘§", "ğŸ§‘",
            "ğŸ‘±", "ğŸ‘¨", "ğŸ§”", "ğŸ‘©", "ğŸ§“", "ğŸ‘´", "ğŸ‘µ", "ğŸ‘²", "ğŸ§•", "ğŸ¤´", "ğŸ‘¸", "ğŸ‘³", "ğŸ‘¶", "ğŸ‘·", "ğŸ’‚", "ğŸ•µï¸", "ğŸ‘©â€âš•ï¸", "ğŸ‘¨â€ğŸŒ¾", "ğŸ‘©â€ğŸ³", "ğŸ‘¨â€ğŸ“",
            "ğŸ‘©â€ğŸ¤", "ğŸ‘¨â€ğŸ«", "ğŸ‘©â€ğŸ­", "ğŸ‘¨â€ğŸ’»", "ğŸ‘©â€ğŸ’¼", "ğŸ‘¨â€ğŸ”§", "ğŸ‘©â€ğŸ”¬", "ğŸ‘¨â€ğŸ¨", "ğŸ‘©â€ğŸš’", "ğŸ‘¨â€âœˆï¸", "ğŸ‘©â€ğŸš€", "ğŸ‘¨â€âš–ï¸", "ğŸ‘°", "ğŸ¤µ", "ğŸ‘¸", "ğŸ¤°", "ğŸ¤±", "ğŸ‘¼", "ğŸ…", "ğŸ¤¶",
            "ğŸ¦¸", "ğŸ¦¹", "ğŸ§™", "ğŸ§š", "ğŸ§›", "ğŸ§œ", "ğŸ§", "ğŸ§", "ğŸ§Ÿ", "ğŸ’†", "ğŸ’‡", "ğŸš¶", "ğŸƒ", "ğŸ’ƒ", "ğŸ•º", "ğŸ•´ï¸", "ğŸ‘¯", "ğŸ§–", "ğŸ§—",
            "ğŸ¤º", "ğŸ‡", "â›·ï¸", "ğŸ‚", "ğŸŒï¸", "ğŸ„", "ğŸš£", "ğŸŠ", "â›¹ï¸", "ğŸ‹ï¸", "ğŸš´", "ğŸšµ", "ğŸ¤¸", "ğŸ¤¼", "ğŸ¤½", "ğŸ¤¾", "ğŸ¤¹", "ğŸ§˜", "ğŸ›€", "ğŸ›Œ",
            "ğŸ‘­", "ğŸ‘«", "ğŸ‘¬", "ğŸ’", "ğŸ’", "ğŸ‘¨â€â¤ï¸â€ğŸ‘¨", "ğŸ‘©â€â¤ï¸â€ğŸ‘©", "ğŸ’‘", "ğŸ‘©â€â¤ï¸â€ğŸ‘¨", "ğŸ‘¨â€â¤ï¸â€ğŸ‘¨", "ğŸ‘©â€â¤ï¸â€ğŸ‘©", "ğŸ‘ª", "ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦", "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§", "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦", "ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦", "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘§", "ğŸ—£ï¸", "ğŸ‘¤", "ğŸ‘¥",
            "ğŸµ", "ğŸ’", "ğŸ¦", "ğŸ¦§", "ğŸ¶", "ğŸ•", "ğŸ¦®", "ğŸ•â€ğŸ¦º", "ğŸ©", "ğŸº", "ğŸ¦Š", "ğŸ¦", "ğŸ±", "ğŸˆ", "ğŸ¦", "ğŸ¯", "ğŸ…", "ğŸ†", "ğŸ´",
            "ğŸ", "ğŸ¦„", "ğŸ¦“", "ğŸ¦Œ", "ğŸ®", "ğŸ‚", "ğŸƒ", "ğŸ„", "ğŸ·", "ğŸ–", "ğŸ—", "ğŸ½", "ğŸ", "ğŸ‘", "ğŸ", "ğŸª", "ğŸ«", "ğŸ¦™", "ğŸ¦’", "ğŸ˜",
            "ğŸ¦", "ğŸ¦›", "ğŸ­", "ğŸ", "ğŸ€", "ğŸ¹", "ğŸ°", "ğŸ‡", "ğŸ¿ï¸", "ğŸ¦”", "ğŸ¦‡", "ğŸ»", "ğŸ¨", "ğŸ¼", "ğŸ¦¥", "ğŸ¦¦", "ğŸ¦¨", "ğŸ¦˜", "ğŸ¦¡", "ğŸ¾",
            "ğŸ¦ƒ", "ğŸ”", "ğŸ“", "ğŸ£", "ğŸ¤", "ğŸ¥", "ğŸ¦", "ğŸ§", "ğŸ•Šï¸", "ğŸ¦…", "ğŸ¦†", "ğŸ¦¢", "ğŸ¦‰", "ğŸ¦©", "ğŸ¦š", "ğŸ¦œ", "ğŸ¸", "ğŸŠ", "ğŸ¢", "ğŸ¦",
            "ğŸ", "ğŸ²", "ğŸ‰", "ğŸ¦•", "ğŸ¦–", "ğŸ³", "ğŸ‹", "ğŸ¬", "ğŸŸ", "ğŸ ", "ğŸ¡", "ğŸ¦ˆ", "ğŸ™", "ğŸš", "ğŸŒ", "ğŸ¦‹", "ğŸ›", "ğŸœ", "ğŸ", "ğŸ",
            "ğŸ¦—", "ğŸ•·ï¸", "ğŸ•¸ï¸", "ğŸ¦‚", "ğŸ¦Ÿ", "ğŸ¦ ", "ğŸ’", "ğŸŒ¸", "ğŸ’®", "ğŸŒ¹", "ğŸŒº", "ğŸŒ»", "ğŸŒ¼", "ğŸŒ·", "ğŸŒ±", "ğŸŒ²", "ğŸŒ³", "ğŸŒ´", "ğŸŒµ", "ğŸŒ¾",
            "ğŸŒ¿", "â˜˜ï¸", "ğŸ€", "ğŸ", "ğŸ‚", "ğŸƒ", "ğŸ‡", "ğŸˆ", "ğŸ‰", "ğŸŠ", "ğŸ‹", "ğŸŒ", "ğŸ", "ğŸ¥­", "ğŸ", "ğŸ", "ğŸ", "ğŸ‘", "ğŸ’", "ğŸ“",
            "ğŸ¥", "ğŸ…", "ğŸ¥¥", "ğŸ¥‘", "ğŸ†", "ğŸ¥”", "ğŸ¥•", "ğŸŒ½", "ğŸŒ¶ï¸", "ğŸ¥’", "ğŸ¥¬", "ğŸ¥¦", "ğŸ§„", "ğŸ§…", "ğŸ„", "ğŸ¥œ", "ğŸŒ°", "ğŸ", "ğŸ¥", "ğŸ¥–",
            "ğŸ¥¨", "ğŸ¥¯", "ğŸ¥", "ğŸ§‡", "ğŸ§€", "ğŸ–", "ğŸ—", "ğŸ¥©", "ğŸ¥“", "ğŸ”", "ğŸŸ", "ğŸ•", "ğŸŒ­", "ğŸ¥ª", "ğŸŒ®", "ğŸŒ¯", "ğŸ¥™", "ğŸ¥š", "ğŸ³", "ğŸ¥˜",
            "ğŸ²", "ğŸ¥£", "ğŸ¥—", "ğŸ¿", "ğŸ§ˆ", "ğŸ§‚", "ğŸ¥«", "ğŸ±", "ğŸ˜", "ğŸ™", "ğŸš", "ğŸ›", "ğŸœ", "ğŸ", "ğŸ ", "ğŸ¢", "ğŸ£", "ğŸ¤", "ğŸ¥", "ğŸ¥®",
            "ğŸ¡", "ğŸ¥Ÿ", "ğŸ¥ ", "ğŸ¥¡", "ğŸ¦", "ğŸ§", "ğŸ¨", "ğŸ©", "ğŸª", "ğŸ‚", "ğŸ°", "ğŸ§", "ğŸ¥§", "ğŸ«", "ğŸ¬", "ğŸ­", "ğŸ®", "ğŸ¯", "ğŸ¼", "ğŸ¥›"
        ];

        let curLevel = 0;
        let score = 0;
        let timeLeft = 60;
        let timerId = null;
        let tiles = [];
        let selectedIdx = null;
        let size = 3;

        function updateDifficulty() {
            // Logika Gradual Difficulty
            if (curLevel < 20) {
                size = 3;
            } else if (curLevel < 100) {
                size = 4;
            } else {
                size = 5;
            }
            document.getElementById('grd').innerText = `${size}x${size}`;
        }

        function init() {
            updateDifficulty();
            document.getElementById('lvl').innerText = curLevel + 1;
            
            // Atur waktu (makin tinggi level makin sedikit waktu bonusnya)
            timeLeft = 60; 
            document.getElementById('tmr').innerText = timeLeft;
            document.getElementById('tmr').classList.remove('timer-warning');

            const total = size * size;
            tiles = Array.from({length: total}, (_, i) => i);
            shuffle(tiles);
            render();
            startTimer();
        }

        function render() {
            const board = document.getElementById('board');
            board.innerHTML = '';
            
            // Ukuran kotak adaptif agar muat di layar
            let tSize = size === 3 ? 100 : (size === 4 ? 75 : 60);
            board.style.gridTemplateColumns = `repeat(${size}, ${tSize}px)`;
            
            const emoji = levelEmojis[curLevel % levelEmojis.length];

            tiles.forEach((val, pos) => {
                const div = document.createElement('div');
                div.className = 'tile';
                div.style.width = div.style.height = `${tSize}px`;

                if (val === (size * size) - 1) {
                    div.classList.add('empty');
                } else {
                    const s = document.createElement('span');
                    s.innerText = emoji;
                    s.style.position = 'absolute';
                    s.style.fontSize = `${size * tSize * 0.8}px`;
                    
                    const r = Math.floor(val / size);
                    const c = val % size;
                    s.style.left = `-${c * tSize}px`;
                    s.style.top = `-${r * tSize}px`;
                    
                    div.appendChild(s);
                    if (selectedIdx === pos) div.classList.add('selected');
                }
                div.onclick = () => handleClick(pos);
                board.appendChild(div);
            });
        }

        function handleClick(pos) {
            const emptyPos = tiles.indexOf((size * size) - 1);

            if (selectedIdx === null) {
                if (tiles[pos] !== (size * size) - 1) selectedIdx = pos;
            } else {
                if (pos === emptyPos) {
                    [tiles[selectedIdx], tiles[pos]] = [tiles[pos], tiles[selectedIdx]];
                    selectedIdx = null;
                    checkWin();
                } else {
                    selectedIdx = (tiles[pos] === (size * size) - 1) ? null : pos;
                }
            }
            render();
        }

        function startTimer() {
            clearInterval(timerId);
            timerId = setInterval(() => {
                timeLeft--;
                document.getElementById('tmr').innerText = timeLeft;
                if (timeLeft <= 10) document.getElementById('tmr').classList.add('timer-warning');
                if (timeLeft <= 0) {
                    clearInterval(timerId);
                    alert("WAKTU HABIS! Skor Akhir: " + score);
                    curLevel = 0; score = 0;
                    document.getElementById('skr').innerText = "0";
                    init();
                }
            }, 1000);
        }

        function checkWin() {
            if (tiles.every((v, i) => v === i)) {
                clearInterval(timerId);
                score += (timeLeft * 10) + (size * 50);
                document.getElementById('skr').innerText = score;
                setTimeout(() => {
                    alert(`Level ${curLevel + 1} Berhasil!\nBonus Skor: ${timeLeft * 10}`);
                    curLevel++;
                    init();
                }, 200);
            }
        }

        function shuffle(arr) {
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            if (arr.every((v,i) => v === i)) shuffle(arr);
        }

        function confirmRestart() {
            if(confirm("Ulang dari Level 1?")) {
                curLevel = 0; score = 0;
                document.getElementById('skr').innerText = "0";
                init();
            }
        }

        init();
    </script>
</body>
</html>
